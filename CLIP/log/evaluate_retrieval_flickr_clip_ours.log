| distributed init (rank 2, word 8): env://
| distributed init (rank 5, word 8): env://
| distributed init (rank 7, word 8): env://
| distributed init (rank 3, word 8): env://
| distributed init (rank 0, word 8): env://
| distributed init (rank 6, word 8): env://
| distributed init (rank 1, word 8): env://
| distributed init (rank 4, word 8): env://
Creating retrieval dataset
Using downloaded and verified file: annotation/flickr30k_train.json
Using downloaded and verified file: annotation/flickr30k_val.json
Using downloaded and verified file: annotation/flickr30k_test.json
Creating model
| module                                                      | #parameters or shape   | #flops         |
|:------------------------------------------------------------|:-----------------------|:---------------|
| model                                                       | 149.636M               | 12.036G        |
|  positional_embedding                                       |  (77, 512)             |                |
|  text_projection                                            |  (512, 512)            |                |
|  logit_scale                                                |  ()                    |                |
|  visual                                                     |  86.202M               |  9.011G        |
|   visual.class_embedding                                    |   (768,)               |                |
|   visual.positional_embedding                               |   (197, 768)           |                |
|   visual.proj                                               |   (768, 512)           |                |
|   visual.conv1                                              |   0.59M                |   115.606M     |
|    visual.conv1.weight                                      |    (768, 3, 16, 16)    |                |
|   visual.ln_pre                                             |   1.536K               |   0.76M        |
|    visual.ln_pre.weight                                     |    (768,)              |                |
|    visual.ln_pre.bias                                       |    (768,)              |                |
|   visual.transformer                                        |   85.064M              |   8.894G       |
|    visual.transformer.cross_image                           |    (1, 12, 768)        |                |
|    visual.transformer.resblocks                             |    85.054M             |    8.894G      |
|     visual.transformer.resblocks.0                          |     7.088M             |     1.418G     |
|      visual.transformer.resblocks.0.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.0.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.0.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.0.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.0.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.0.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.0.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.0.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.0.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.0.mlp                     |      4.722M            |      858.784M  |
|       visual.transformer.resblocks.0.mlp.c_fc               |       2.362M           |       429.392M |
|        visual.transformer.resblocks.0.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.0.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.0.mlp.c_proj             |       2.36M            |       429.392M |
|        visual.transformer.resblocks.0.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.0.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.0.ln_2                    |      1.536K            |      0.699M    |
|       visual.transformer.resblocks.0.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.0.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.0.token_reducer           |                        |      30.261M   |
|     visual.transformer.resblocks.1                          |     7.088M             |     1.29G      |
|      visual.transformer.resblocks.1.attn                    |      2.362M            |      480.27M   |
|       visual.transformer.resblocks.1.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.1.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.1.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.1.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.1.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.1.ln_1                    |      1.536K            |      0.699M    |
|       visual.transformer.resblocks.1.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.1.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.1.mlp                     |      4.722M            |      783.286M  |
|       visual.transformer.resblocks.1.mlp.c_fc               |       2.362M           |       391.643M |
|        visual.transformer.resblocks.1.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.1.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.1.mlp.c_proj             |       2.36M            |       391.643M |
|        visual.transformer.resblocks.1.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.1.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.1.ln_2                    |      1.536K            |      0.637M    |
|       visual.transformer.resblocks.1.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.1.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.1.token_reducer           |                        |      25.579M   |
|     visual.transformer.resblocks.2                          |     7.088M             |     1.164G     |
|      visual.transformer.resblocks.2.attn                    |      2.362M            |      433.969M  |
|       visual.transformer.resblocks.2.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.2.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.2.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.2.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.2.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.2.ln_1                    |      1.536K            |      0.637M    |
|       visual.transformer.resblocks.2.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.2.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.2.mlp                     |      4.722M            |      707.789M  |
|       visual.transformer.resblocks.2.mlp.c_fc               |       2.362M           |       353.894M |
|        visual.transformer.resblocks.2.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.2.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.2.mlp.c_proj             |       2.36M            |       353.894M |
|        visual.transformer.resblocks.2.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.2.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.2.ln_2                    |      1.536K            |      0.576M    |
|       visual.transformer.resblocks.2.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.2.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.2.token_reducer           |                        |      21.29M    |
|     visual.transformer.resblocks.3                          |     7.088M             |     1.039G     |
|      visual.transformer.resblocks.3.attn                    |      2.362M            |      388.454M  |
|       visual.transformer.resblocks.3.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.3.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.3.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.3.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.3.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.3.ln_1                    |      1.536K            |      0.576M    |
|       visual.transformer.resblocks.3.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.3.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.3.mlp                     |      4.722M            |      632.291M  |
|       visual.transformer.resblocks.3.mlp.c_fc               |       2.362M           |       316.146M |
|        visual.transformer.resblocks.3.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.3.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.3.mlp.c_proj             |       2.36M            |       316.146M |
|        visual.transformer.resblocks.3.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.3.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.3.ln_2                    |      1.536K            |      0.515M    |
|       visual.transformer.resblocks.3.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.3.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.3.token_reducer           |                        |      17.395M   |
|     visual.transformer.resblocks.4                          |     7.088M             |     915.381M   |
|      visual.transformer.resblocks.4.attn                    |      2.362M            |      343.726M  |
|       visual.transformer.resblocks.4.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.4.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.4.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.4.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.4.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.4.ln_1                    |      1.536K            |      0.515M    |
|       visual.transformer.resblocks.4.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.4.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.4.mlp                     |      4.722M            |      556.794M  |
|       visual.transformer.resblocks.4.mlp.c_fc               |       2.362M           |       278.397M |
|        visual.transformer.resblocks.4.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.4.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.4.mlp.c_proj             |       2.36M            |       278.397M |
|        visual.transformer.resblocks.4.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.4.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.4.ln_2                    |      1.536K            |      0.453M    |
|       visual.transformer.resblocks.4.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.4.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.4.token_reducer           |                        |      13.893M   |
|     visual.transformer.resblocks.5                          |     7.088M             |     792.71M    |
|      visual.transformer.resblocks.5.attn                    |      2.362M            |      299.784M  |
|       visual.transformer.resblocks.5.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.5.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.5.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.5.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.5.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.5.ln_1                    |      1.536K            |      0.453M    |
|       visual.transformer.resblocks.5.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.5.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.5.mlp                     |      4.722M            |      481.296M  |
|       visual.transformer.resblocks.5.mlp.c_fc               |       2.362M           |       240.648M |
|        visual.transformer.resblocks.5.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.5.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.5.mlp.c_proj             |       2.36M            |       240.648M |
|        visual.transformer.resblocks.5.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.5.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.5.ln_2                    |      1.536K            |      0.392M    |
|       visual.transformer.resblocks.5.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.5.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.5.token_reducer           |                        |      10.784M   |
|     visual.transformer.resblocks.6                          |     7.088M             |     671.218M   |
|      visual.transformer.resblocks.6.attn                    |      2.362M            |      256.629M  |
|       visual.transformer.resblocks.6.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.6.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.6.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.6.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.6.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.6.ln_1                    |      1.536K            |      0.392M    |
|       visual.transformer.resblocks.6.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.6.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.6.mlp                     |      4.722M            |      405.799M  |
|       visual.transformer.resblocks.6.mlp.c_fc               |       2.362M           |       202.899M |
|        visual.transformer.resblocks.6.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.6.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.6.mlp.c_proj             |       2.36M            |       202.899M |
|        visual.transformer.resblocks.6.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.6.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.6.ln_2                    |      1.536K            |      0.33M     |
|       visual.transformer.resblocks.6.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.6.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.6.token_reducer           |                        |      8.069M    |
|     visual.transformer.resblocks.7                          |     7.088M             |     550.906M   |
|      visual.transformer.resblocks.7.attn                    |      2.362M            |      214.26M   |
|       visual.transformer.resblocks.7.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.7.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.7.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.7.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.7.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.7.ln_1                    |      1.536K            |      0.33M     |
|       visual.transformer.resblocks.7.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.7.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.7.mlp                     |      4.722M            |      330.301M  |
|       visual.transformer.resblocks.7.mlp.c_fc               |       2.362M           |       165.151M |
|        visual.transformer.resblocks.7.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.7.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.7.mlp.c_proj             |       2.36M            |       165.151M |
|        visual.transformer.resblocks.7.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.7.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.7.ln_2                    |      1.536K            |      0.269M    |
|       visual.transformer.resblocks.7.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.7.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.7.token_reducer           |                        |      5.746M    |
|     visual.transformer.resblocks.8                          |     7.088M             |     431.774M   |
|      visual.transformer.resblocks.8.attn                    |      2.362M            |      172.677M  |
|       visual.transformer.resblocks.8.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.8.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.8.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.8.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.8.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.8.ln_1                    |      1.536K            |      0.269M    |
|       visual.transformer.resblocks.8.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.8.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.8.mlp                     |      4.722M            |      254.804M  |
|       visual.transformer.resblocks.8.mlp.c_fc               |       2.362M           |       127.402M |
|        visual.transformer.resblocks.8.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.8.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.8.mlp.c_proj             |       2.36M            |       127.402M |
|        visual.transformer.resblocks.8.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.8.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.8.ln_2                    |      1.536K            |      0.207M    |
|       visual.transformer.resblocks.8.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.8.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.8.token_reducer           |                        |      3.817M    |
|     visual.transformer.resblocks.9                          |     7.088M             |     313.822M   |
|      visual.transformer.resblocks.9.attn                    |      2.362M            |      131.881M  |
|       visual.transformer.resblocks.9.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.9.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.9.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.9.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.9.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.9.ln_1                    |      1.536K            |      0.207M    |
|       visual.transformer.resblocks.9.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.9.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.9.mlp                     |      4.722M            |      179.306M  |
|       visual.transformer.resblocks.9.mlp.c_fc               |       2.362M           |       89.653M  |
|        visual.transformer.resblocks.9.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.9.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.9.mlp.c_proj             |       2.36M            |       89.653M  |
|        visual.transformer.resblocks.9.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.9.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.9.ln_2                    |      1.536K            |      0.146M    |
|       visual.transformer.resblocks.9.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.9.ln_2.bias              |       (768,)           |                |
|      visual.transformer.resblocks.9.token_reducer           |                        |      2.281M    |
|     visual.transformer.resblocks.10                         |     7.088M             |     197.049M   |
|      visual.transformer.resblocks.10.attn                   |      2.362M            |      91.871M   |
|       visual.transformer.resblocks.10.attn.in_proj_weight   |       (2304, 768)      |                |
|       visual.transformer.resblocks.10.attn.in_proj_bias     |       (2304,)          |                |
|       visual.transformer.resblocks.10.attn.out_proj         |       0.591M           |                |
|        visual.transformer.resblocks.10.attn.out_proj.weight |        (768, 768)      |                |
|        visual.transformer.resblocks.10.attn.out_proj.bias   |        (768,)          |                |
|      visual.transformer.resblocks.10.ln_1                   |      1.536K            |      0.146M    |
|       visual.transformer.resblocks.10.ln_1.weight           |       (768,)           |                |
|       visual.transformer.resblocks.10.ln_1.bias             |       (768,)           |                |
|      visual.transformer.resblocks.10.mlp                    |      4.722M            |      103.809M  |
|       visual.transformer.resblocks.10.mlp.c_fc              |       2.362M           |       51.905M  |
|        visual.transformer.resblocks.10.mlp.c_fc.weight      |        (3072, 768)     |                |
|        visual.transformer.resblocks.10.mlp.c_fc.bias        |        (3072,)         |                |
|       visual.transformer.resblocks.10.mlp.c_proj            |       2.36M            |       51.905M  |
|        visual.transformer.resblocks.10.mlp.c_proj.weight    |        (768, 3072)     |                |
|        visual.transformer.resblocks.10.mlp.c_proj.bias      |        (768,)          |                |
|      visual.transformer.resblocks.10.ln_2                   |      1.536K            |      84.48K    |
|       visual.transformer.resblocks.10.ln_2.weight           |       (768,)           |                |
|       visual.transformer.resblocks.10.ln_2.bias             |       (768,)           |                |
|      visual.transformer.resblocks.10.token_reducer          |                        |      1.138M    |
|     visual.transformer.resblocks.11                         |     7.088M             |     109.79M    |
|      visual.transformer.resblocks.11.attn                   |      2.362M            |      52.648M   |
|       visual.transformer.resblocks.11.attn.in_proj_weight   |       (2304, 768)      |                |
|       visual.transformer.resblocks.11.attn.in_proj_bias     |       (2304,)          |                |
|       visual.transformer.resblocks.11.attn.out_proj         |       0.591M           |                |
|        visual.transformer.resblocks.11.attn.out_proj.weight |        (768, 768)      |                |
|        visual.transformer.resblocks.11.attn.out_proj.bias   |        (768,)          |                |
|      visual.transformer.resblocks.11.ln_1                   |      1.536K            |      84.48K    |
|       visual.transformer.resblocks.11.ln_1.weight           |       (768,)           |                |
|       visual.transformer.resblocks.11.ln_1.bias             |       (768,)           |                |
|      visual.transformer.resblocks.11.mlp                    |      4.722M            |      56.623M   |
|       visual.transformer.resblocks.11.mlp.c_fc              |       2.362M           |       28.312M  |
|        visual.transformer.resblocks.11.mlp.c_fc.weight      |        (3072, 768)     |                |
|        visual.transformer.resblocks.11.mlp.c_fc.bias        |        (3072,)         |                |
|       visual.transformer.resblocks.11.mlp.c_proj            |       2.36M            |       28.312M  |
|        visual.transformer.resblocks.11.mlp.c_proj.weight    |        (768, 3072)     |                |
|        visual.transformer.resblocks.11.mlp.c_proj.bias      |        (768,)          |                |
|      visual.transformer.resblocks.11.ln_2                   |      1.536K            |      46.08K    |
|       visual.transformer.resblocks.11.ln_2.weight           |       (768,)           |                |
|       visual.transformer.resblocks.11.ln_2.bias             |       (768,)           |                |
|      visual.transformer.resblocks.11.token_reducer          |                        |      0.389M    |
|   visual.ln_post                                            |   1.536K               |   3.84K        |
|    visual.ln_post.weight                                    |    (768,)              |                |
|    visual.ln_post.bias                                      |    (768,)              |                |
|  transformer                                                |  37.835M               |  3.024G        |
|   transformer.cross_text                                    |   (1, 12, 512)         |                |
|   transformer.resblocks                                     |   37.829M              |   3.024G       |
|    transformer.resblocks.0                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.0.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.0.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.0.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.0.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.0.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.0.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.0.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.0.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.0.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.0.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.0.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.0.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.0.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.0.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.0.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.0.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.0.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.0.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.0.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.1                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.1.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.1.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.1.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.1.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.1.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.1.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.1.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.1.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.1.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.1.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.1.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.1.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.1.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.1.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.1.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.1.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.1.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.1.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.1.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.2                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.2.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.2.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.2.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.2.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.2.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.2.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.2.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.2.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.2.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.2.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.2.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.2.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.2.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.2.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.2.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.2.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.2.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.2.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.2.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.3                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.3.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.3.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.3.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.3.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.3.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.3.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.3.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.3.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.3.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.3.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.3.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.3.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.3.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.3.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.3.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.3.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.3.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.3.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.3.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.4                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.4.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.4.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.4.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.4.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.4.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.4.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.4.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.4.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.4.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.4.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.4.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.4.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.4.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.4.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.4.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.4.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.4.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.4.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.4.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.5                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.5.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.5.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.5.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.5.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.5.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.5.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.5.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.5.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.5.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.5.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.5.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.5.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.5.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.5.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.5.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.5.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.5.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.5.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.5.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.6                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.6.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.6.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.6.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.6.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.6.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.6.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.6.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.6.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.6.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.6.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.6.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.6.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.6.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.6.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.6.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.6.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.6.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.6.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.6.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.7                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.7.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.7.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.7.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.7.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.7.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.7.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.7.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.7.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.7.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.7.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.7.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.7.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.7.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.7.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.7.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.7.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.7.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.7.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.7.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.8                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.8.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.8.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.8.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.8.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.8.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.8.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.8.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.8.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.8.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.8.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.8.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.8.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.8.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.8.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.8.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.8.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.8.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.8.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.8.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.9                                  |    3.152M              |    251.996M    |
|     transformer.resblocks.9.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.9.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.9.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.9.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.9.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.9.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.9.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.9.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.9.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.9.mlp                             |     2.1M               |     163.578M   |
|      transformer.resblocks.9.mlp.c_fc                       |      1.051M            |      81.789M   |
|       transformer.resblocks.9.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.9.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.9.mlp.c_proj                     |      1.049M            |      81.789M   |
|       transformer.resblocks.9.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.9.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.9.ln_2                            |     1.024K             |     0.2M       |
|      transformer.resblocks.9.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.9.ln_2.bias                      |      (512,)            |                |
|    transformer.resblocks.10                                 |    3.152M              |    251.996M    |
|     transformer.resblocks.10.attn                           |     1.051M             |     88.019M    |
|      transformer.resblocks.10.attn.in_proj_weight           |      (1536, 512)       |                |
|      transformer.resblocks.10.attn.in_proj_bias             |      (1536,)           |                |
|      transformer.resblocks.10.attn.out_proj                 |      0.263M            |                |
|       transformer.resblocks.10.attn.out_proj.weight         |       (512, 512)       |                |
|       transformer.resblocks.10.attn.out_proj.bias           |       (512,)           |                |
|     transformer.resblocks.10.ln_1                           |     1.024K             |     0.2M       |
|      transformer.resblocks.10.ln_1.weight                   |      (512,)            |                |
|      transformer.resblocks.10.ln_1.bias                     |      (512,)            |                |
|     transformer.resblocks.10.mlp                            |     2.1M               |     163.578M   |
|      transformer.resblocks.10.mlp.c_fc                      |      1.051M            |      81.789M   |
|       transformer.resblocks.10.mlp.c_fc.weight              |       (2048, 512)      |                |
|       transformer.resblocks.10.mlp.c_fc.bias                |       (2048,)          |                |
|      transformer.resblocks.10.mlp.c_proj                    |      1.049M            |      81.789M   |
|       transformer.resblocks.10.mlp.c_proj.weight            |       (512, 2048)      |                |
|       transformer.resblocks.10.mlp.c_proj.bias              |       (512,)           |                |
|     transformer.resblocks.10.ln_2                           |     1.024K             |     0.2M       |
|      transformer.resblocks.10.ln_2.weight                   |      (512,)            |                |
|      transformer.resblocks.10.ln_2.bias                     |      (512,)            |                |
|    transformer.resblocks.11                                 |    3.152M              |    251.996M    |
|     transformer.resblocks.11.attn                           |     1.051M             |     88.019M    |
|      transformer.resblocks.11.attn.in_proj_weight           |      (1536, 512)       |                |
|      transformer.resblocks.11.attn.in_proj_bias             |      (1536,)           |                |
|      transformer.resblocks.11.attn.out_proj                 |      0.263M            |                |
|       transformer.resblocks.11.attn.out_proj.weight         |       (512, 512)       |                |
|       transformer.resblocks.11.attn.out_proj.bias           |       (512,)           |                |
|     transformer.resblocks.11.ln_1                           |     1.024K             |     0.2M       |
|      transformer.resblocks.11.ln_1.weight                   |      (512,)            |                |
|      transformer.resblocks.11.ln_1.bias                     |      (512,)            |                |
|     transformer.resblocks.11.mlp                            |     2.1M               |     163.578M   |
|      transformer.resblocks.11.mlp.c_fc                      |      1.051M            |      81.789M   |
|       transformer.resblocks.11.mlp.c_fc.weight              |       (2048, 512)      |                |
|       transformer.resblocks.11.mlp.c_fc.bias                |       (2048,)          |                |
|      transformer.resblocks.11.mlp.c_proj                    |      1.049M            |      81.789M   |
|       transformer.resblocks.11.mlp.c_proj.weight            |       (512, 2048)      |                |
|       transformer.resblocks.11.mlp.c_proj.bias              |       (512,)           |                |
|     transformer.resblocks.11.ln_2                           |     1.024K             |     0.2M       |
|      transformer.resblocks.11.ln_2.weight                   |      (512,)            |                |
|      transformer.resblocks.11.ln_2.bias                     |      (512,)            |                |
|  token_embedding                                            |  25.297M               |  0             |
|   token_embedding.weight                                    |   (49408, 512)         |                |
|  ln_final                                                   |  1.024K                |  0.2M          |
|   ln_final.weight                                           |   (512,)               |                |
|   ln_final.bias                                             |   (512,)               |                |
Total 12.035655936
Start training
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 92.01183431952663, 'txt_r5': 99.5069033530572, 'txt_r10': 99.90138067061145, 'txt_r_mean': 97.14003944773175, 'img_r1': 79.72386587771203, 'img_r5': 95.54240631163708, 'img_r10': 97.94871794871794, 'img_r_mean': 91.07166337935568, 'r_mean': 94.10585141354372}
{'txt_r1': 92.1, 'txt_r5': 99.7, 'txt_r10': 99.8, 'txt_r_mean': 97.2, 'img_r1': 79.6, 'img_r5': 95.74, 'img_r10': 98.0, 'img_r_mean': 91.11333333333333, 'r_mean': 94.15666666666667}
LOG:  {'val_txt_r1': 92.01183431952663, 'val_txt_r5': 99.5069033530572, 'val_txt_r10': 99.90138067061145, 'val_txt_r_mean': 97.14003944773175, 'val_img_r1': 79.72386587771203, 'val_img_r5': 95.54240631163708, 'val_img_r10': 97.94871794871794, 'val_img_r_mean': 91.07166337935568, 'val_r_mean': 94.10585141354372, 'test_txt_r1': 92.1, 'test_txt_r5': 99.7, 'test_txt_r10': 99.8, 'test_txt_r_mean': 97.2, 'test_img_r1': 79.6, 'test_img_r5': 95.74, 'test_img_r10': 98.0, 'test_img_r_mean': 91.11333333333333, 'test_r_mean': 94.15666666666667}
Training time 0:00:25
