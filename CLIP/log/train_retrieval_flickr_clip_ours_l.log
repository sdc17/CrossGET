| distributed init (rank 1, word 8): env://
| distributed init (rank 5, word 8): env://
| distributed init (rank 0, word 8): env://
| distributed init (rank 7, word 8): env://
| distributed init (rank 4, word 8): env://
| distributed init (rank 2, word 8): env://
| distributed init (rank 3, word 8): env://
| distributed init (rank 6, word 8): env://
Creating retrieval dataset
Using downloaded and verified file: annotation/flickr30k_train.json
Using downloaded and verified file: annotation/flickr30k_val.json
Using downloaded and verified file: annotation/flickr30k_test.json
Creating model
| module                                                      | #parameters or shape   | #flops         |
|:------------------------------------------------------------|:-----------------------|:---------------|
| model                                                       | 149.636M               | 19.275G        |
|  positional_embedding                                       |  (77, 512)             |                |
|  text_projection                                            |  (512, 512)            |                |
|  logit_scale                                                |  ()                    |                |
|  visual                                                     |  86.202M               |  17.675G       |
|   visual.class_embedding                                    |   (768,)               |                |
|   visual.positional_embedding                               |   (197, 768)           |                |
|   visual.proj                                               |   (768, 512)           |                |
|   visual.conv1                                              |   0.59M                |   115.606M     |
|    visual.conv1.weight                                      |    (768, 3, 16, 16)    |                |
|   visual.ln_pre                                             |   1.536K               |   0.76M        |
|    visual.ln_pre.weight                                     |    (768,)              |                |
|    visual.ln_pre.bias                                       |    (768,)              |                |
|   visual.transformer                                        |   85.064M              |   17.558G      |
|    visual.transformer.cross_image                           |    (1, 12, 768)        |                |
|    visual.transformer.resblocks                             |    85.054M             |    17.558G     |
|     visual.transformer.resblocks.0                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.0.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.0.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.0.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.0.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.0.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.0.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.0.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.0.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.0.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.0.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.0.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.0.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.0.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.0.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.0.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.0.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.0.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.0.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.0.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.1                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.1.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.1.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.1.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.1.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.1.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.1.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.1.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.1.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.1.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.1.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.1.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.1.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.1.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.1.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.1.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.1.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.1.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.1.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.1.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.2                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.2.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.2.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.2.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.2.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.2.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.2.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.2.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.2.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.2.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.2.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.2.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.2.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.2.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.2.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.2.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.2.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.2.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.2.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.2.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.3                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.3.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.3.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.3.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.3.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.3.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.3.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.3.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.3.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.3.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.3.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.3.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.3.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.3.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.3.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.3.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.3.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.3.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.3.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.3.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.4                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.4.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.4.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.4.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.4.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.4.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.4.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.4.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.4.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.4.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.4.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.4.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.4.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.4.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.4.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.4.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.4.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.4.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.4.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.4.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.5                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.5.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.5.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.5.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.5.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.5.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.5.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.5.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.5.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.5.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.5.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.5.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.5.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.5.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.5.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.5.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.5.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.5.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.5.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.5.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.6                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.6.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.6.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.6.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.6.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.6.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.6.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.6.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.6.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.6.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.6.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.6.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.6.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.6.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.6.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.6.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.6.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.6.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.6.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.6.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.7                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.7.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.7.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.7.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.7.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.7.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.7.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.7.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.7.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.7.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.7.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.7.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.7.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.7.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.7.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.7.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.7.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.7.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.7.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.7.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.8                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.8.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.8.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.8.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.8.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.8.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.8.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.8.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.8.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.8.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.8.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.8.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.8.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.8.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.8.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.8.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.8.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.8.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.8.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.8.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.9                          |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.9.attn                    |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.9.attn.in_proj_weight    |       (2304, 768)      |                |
|       visual.transformer.resblocks.9.attn.in_proj_bias      |       (2304,)          |                |
|       visual.transformer.resblocks.9.attn.out_proj          |       0.591M           |                |
|        visual.transformer.resblocks.9.attn.out_proj.weight  |        (768, 768)      |                |
|        visual.transformer.resblocks.9.attn.out_proj.bias    |        (768,)          |                |
|      visual.transformer.resblocks.9.ln_1                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.9.ln_1.weight            |       (768,)           |                |
|       visual.transformer.resblocks.9.ln_1.bias              |       (768,)           |                |
|      visual.transformer.resblocks.9.mlp                     |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.9.mlp.c_fc               |       2.362M           |       467.141M |
|        visual.transformer.resblocks.9.mlp.c_fc.weight       |        (3072, 768)     |                |
|        visual.transformer.resblocks.9.mlp.c_fc.bias         |        (3072,)         |                |
|       visual.transformer.resblocks.9.mlp.c_proj             |       2.36M            |       467.141M |
|        visual.transformer.resblocks.9.mlp.c_proj.weight     |        (768, 3072)     |                |
|        visual.transformer.resblocks.9.mlp.c_proj.bias       |        (768,)          |                |
|      visual.transformer.resblocks.9.ln_2                    |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.9.ln_2.weight            |       (768,)           |                |
|       visual.transformer.resblocks.9.ln_2.bias              |       (768,)           |                |
|     visual.transformer.resblocks.10                         |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.10.attn                   |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.10.attn.in_proj_weight   |       (2304, 768)      |                |
|       visual.transformer.resblocks.10.attn.in_proj_bias     |       (2304,)          |                |
|       visual.transformer.resblocks.10.attn.out_proj         |       0.591M           |                |
|        visual.transformer.resblocks.10.attn.out_proj.weight |        (768, 768)      |                |
|        visual.transformer.resblocks.10.attn.out_proj.bias   |        (768,)          |                |
|      visual.transformer.resblocks.10.ln_1                   |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.10.ln_1.weight           |       (768,)           |                |
|       visual.transformer.resblocks.10.ln_1.bias             |       (768,)           |                |
|      visual.transformer.resblocks.10.mlp                    |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.10.mlp.c_fc              |       2.362M           |       467.141M |
|        visual.transformer.resblocks.10.mlp.c_fc.weight      |        (3072, 768)     |                |
|        visual.transformer.resblocks.10.mlp.c_fc.bias        |        (3072,)         |                |
|       visual.transformer.resblocks.10.mlp.c_proj            |       2.36M            |       467.141M |
|        visual.transformer.resblocks.10.mlp.c_proj.weight    |        (768, 3072)     |                |
|        visual.transformer.resblocks.10.mlp.c_proj.bias      |        (768,)          |                |
|      visual.transformer.resblocks.10.ln_2                   |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.10.ln_2.weight           |       (768,)           |                |
|       visual.transformer.resblocks.10.ln_2.bias             |       (768,)           |                |
|     visual.transformer.resblocks.11                         |     7.088M             |     1.463G     |
|      visual.transformer.resblocks.11.attn                   |      2.362M            |      527.358M  |
|       visual.transformer.resblocks.11.attn.in_proj_weight   |       (2304, 768)      |                |
|       visual.transformer.resblocks.11.attn.in_proj_bias     |       (2304,)          |                |
|       visual.transformer.resblocks.11.attn.out_proj         |       0.591M           |                |
|        visual.transformer.resblocks.11.attn.out_proj.weight |        (768, 768)      |                |
|        visual.transformer.resblocks.11.attn.out_proj.bias   |        (768,)          |                |
|      visual.transformer.resblocks.11.ln_1                   |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.11.ln_1.weight           |       (768,)           |                |
|       visual.transformer.resblocks.11.ln_1.bias             |       (768,)           |                |
|      visual.transformer.resblocks.11.mlp                    |      4.722M            |      934.281M  |
|       visual.transformer.resblocks.11.mlp.c_fc              |       2.362M           |       467.141M |
|        visual.transformer.resblocks.11.mlp.c_fc.weight      |        (3072, 768)     |                |
|        visual.transformer.resblocks.11.mlp.c_fc.bias        |        (3072,)         |                |
|       visual.transformer.resblocks.11.mlp.c_proj            |       2.36M            |       467.141M |
|        visual.transformer.resblocks.11.mlp.c_proj.weight    |        (768, 3072)     |                |
|        visual.transformer.resblocks.11.mlp.c_proj.bias      |        (768,)          |                |
|      visual.transformer.resblocks.11.ln_2                   |      1.536K            |      0.76M     |
|       visual.transformer.resblocks.11.ln_2.weight           |       (768,)           |                |
|       visual.transformer.resblocks.11.ln_2.bias             |       (768,)           |                |
|   visual.ln_post                                            |   1.536K               |   3.84K        |
|    visual.ln_post.weight                                    |    (768,)              |                |
|    visual.ln_post.bias                                      |    (768,)              |                |
|  transformer                                                |  37.835M               |  1.6G          |
|   transformer.cross_text                                    |   (1, 12, 512)         |                |
|   transformer.resblocks                                     |   37.829M              |   1.6G         |
|    transformer.resblocks.0                                  |    3.152M              |    242.553M    |
|     transformer.resblocks.0.attn                            |     1.051M             |     88.019M    |
|      transformer.resblocks.0.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.0.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.0.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.0.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.0.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.0.ln_1                            |     1.024K             |     0.2M       |
|      transformer.resblocks.0.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.0.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.0.mlp                             |     2.1M               |     150.995M   |
|      transformer.resblocks.0.mlp.c_fc                       |      1.051M            |      75.497M   |
|       transformer.resblocks.0.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.0.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.0.mlp.c_proj                     |      1.049M            |      75.497M   |
|       transformer.resblocks.0.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.0.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.0.ln_2                            |     1.024K             |     0.184M     |
|      transformer.resblocks.0.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.0.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.0.token_reducer                   |                        |     3.155M     |
|    transformer.resblocks.1                                  |    3.152M              |    222.262M    |
|     transformer.resblocks.1.attn                            |     1.051M             |     80.806M    |
|      transformer.resblocks.1.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.1.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.1.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.1.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.1.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.1.ln_1                            |     1.024K             |     0.184M     |
|      transformer.resblocks.1.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.1.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.1.mlp                             |     2.1M               |     138.412M   |
|      transformer.resblocks.1.mlp.c_fc                       |      1.051M            |      69.206M   |
|       transformer.resblocks.1.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.1.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.1.mlp.c_proj                     |      1.049M            |      69.206M   |
|       transformer.resblocks.1.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.1.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.1.ln_2                            |     1.024K             |     0.169M     |
|      transformer.resblocks.1.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.1.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.1.token_reducer                   |                        |     2.691M     |
|    transformer.resblocks.2                                  |    3.152M              |    202.082M    |
|     transformer.resblocks.2.attn                            |     1.051M             |     73.667M    |
|      transformer.resblocks.2.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.2.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.2.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.2.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.2.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.2.ln_1                            |     1.024K             |     0.169M     |
|      transformer.resblocks.2.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.2.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.2.mlp                             |     2.1M               |     125.829M   |
|      transformer.resblocks.2.mlp.c_fc                       |      1.051M            |      62.915M   |
|       transformer.resblocks.2.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.2.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.2.mlp.c_proj                     |      1.049M            |      62.915M   |
|       transformer.resblocks.2.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.2.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.2.ln_2                            |     1.024K             |     0.154M     |
|      transformer.resblocks.2.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.2.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.2.token_reducer                   |                        |     2.264M     |
|    transformer.resblocks.3                                  |    3.152M              |    182.013M    |
|     transformer.resblocks.3.attn                            |     1.051M             |     66.601M    |
|      transformer.resblocks.3.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.3.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.3.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.3.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.3.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.3.ln_1                            |     1.024K             |     0.154M     |
|      transformer.resblocks.3.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.3.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.3.mlp                             |     2.1M               |     113.246M   |
|      transformer.resblocks.3.mlp.c_fc                       |      1.051M            |      56.623M   |
|       transformer.resblocks.3.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.3.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.3.mlp.c_proj                     |      1.049M            |      56.623M   |
|       transformer.resblocks.3.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.3.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.3.ln_2                            |     1.024K             |     0.138M     |
|      transformer.resblocks.3.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.3.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.3.token_reducer                   |                        |     1.874M     |
|    transformer.resblocks.4                                  |    3.152M              |    162.054M    |
|     transformer.resblocks.4.attn                            |     1.051M             |     59.609M    |
|      transformer.resblocks.4.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.4.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.4.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.4.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.4.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.4.ln_1                            |     1.024K             |     0.138M     |
|      transformer.resblocks.4.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.4.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.4.mlp                             |     2.1M               |     100.663M   |
|      transformer.resblocks.4.mlp.c_fc                       |      1.051M            |      50.332M   |
|       transformer.resblocks.4.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.4.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.4.mlp.c_proj                     |      1.049M            |      50.332M   |
|       transformer.resblocks.4.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.4.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.4.ln_2                            |     1.024K             |     0.123M     |
|      transformer.resblocks.4.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.4.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.4.token_reducer                   |                        |     1.521M     |
|    transformer.resblocks.5                                  |    3.152M              |    142.206M    |
|     transformer.resblocks.5.attn                            |     1.051M             |     52.691M    |
|      transformer.resblocks.5.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.5.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.5.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.5.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.5.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.5.ln_1                            |     1.024K             |     0.123M     |
|      transformer.resblocks.5.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.5.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.5.mlp                             |     2.1M               |     88.08M     |
|      transformer.resblocks.5.mlp.c_fc                       |      1.051M            |      44.04M    |
|       transformer.resblocks.5.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.5.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.5.mlp.c_proj                     |      1.049M            |      44.04M    |
|       transformer.resblocks.5.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.5.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.5.ln_2                            |     1.024K             |     0.108M     |
|      transformer.resblocks.5.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.5.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.5.token_reducer                   |                        |     1.204M     |
|    transformer.resblocks.6                                  |    3.152M              |    122.468M    |
|     transformer.resblocks.6.attn                            |     1.051M             |     45.847M    |
|      transformer.resblocks.6.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.6.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.6.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.6.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.6.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.6.ln_1                            |     1.024K             |     0.108M     |
|      transformer.resblocks.6.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.6.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.6.mlp                             |     2.1M               |     75.497M    |
|      transformer.resblocks.6.mlp.c_fc                       |      1.051M            |      37.749M   |
|       transformer.resblocks.6.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.6.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.6.mlp.c_proj                     |      1.049M            |      37.749M   |
|       transformer.resblocks.6.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.6.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.6.ln_2                            |     1.024K             |     92.16K     |
|      transformer.resblocks.6.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.6.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.6.token_reducer                   |                        |     0.925M     |
|    transformer.resblocks.7                                  |    3.152M              |    102.841M    |
|     transformer.resblocks.7.attn                            |     1.051M             |     39.076M    |
|      transformer.resblocks.7.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.7.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.7.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.7.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.7.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.7.ln_1                            |     1.024K             |     92.16K     |
|      transformer.resblocks.7.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.7.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.7.mlp                             |     2.1M               |     62.915M    |
|      transformer.resblocks.7.mlp.c_fc                       |      1.051M            |      31.457M   |
|       transformer.resblocks.7.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.7.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.7.mlp.c_proj                     |      1.049M            |      31.457M   |
|       transformer.resblocks.7.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.7.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.7.ln_2                            |     1.024K             |     76.8K      |
|      transformer.resblocks.7.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.7.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.7.token_reducer                   |                        |     0.682M     |
|    transformer.resblocks.8                                  |    3.152M              |    83.325M     |
|     transformer.resblocks.8.attn                            |     1.051M             |     32.379M    |
|      transformer.resblocks.8.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.8.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.8.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.8.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.8.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.8.ln_1                            |     1.024K             |     76.8K      |
|      transformer.resblocks.8.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.8.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.8.mlp                             |     2.1M               |     50.332M    |
|      transformer.resblocks.8.mlp.c_fc                       |      1.051M            |      25.166M   |
|       transformer.resblocks.8.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.8.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.8.mlp.c_proj                     |      1.049M            |      25.166M   |
|       transformer.resblocks.8.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.8.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.8.ln_2                            |     1.024K             |     61.44K     |
|      transformer.resblocks.8.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.8.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.8.token_reducer                   |                        |     0.476M     |
|    transformer.resblocks.9                                  |    3.152M              |    63.919M     |
|     transformer.resblocks.9.attn                            |     1.051M             |     25.756M    |
|      transformer.resblocks.9.attn.in_proj_weight            |      (1536, 512)       |                |
|      transformer.resblocks.9.attn.in_proj_bias              |      (1536,)           |                |
|      transformer.resblocks.9.attn.out_proj                  |      0.263M            |                |
|       transformer.resblocks.9.attn.out_proj.weight          |       (512, 512)       |                |
|       transformer.resblocks.9.attn.out_proj.bias            |       (512,)           |                |
|     transformer.resblocks.9.ln_1                            |     1.024K             |     61.44K     |
|      transformer.resblocks.9.ln_1.weight                    |      (512,)            |                |
|      transformer.resblocks.9.ln_1.bias                      |      (512,)            |                |
|     transformer.resblocks.9.mlp                             |     2.1M               |     37.749M    |
|      transformer.resblocks.9.mlp.c_fc                       |      1.051M            |      18.874M   |
|       transformer.resblocks.9.mlp.c_fc.weight               |       (2048, 512)      |                |
|       transformer.resblocks.9.mlp.c_fc.bias                 |       (2048,)          |                |
|      transformer.resblocks.9.mlp.c_proj                     |      1.049M            |      18.874M   |
|       transformer.resblocks.9.mlp.c_proj.weight             |       (512, 2048)      |                |
|       transformer.resblocks.9.mlp.c_proj.bias               |       (512,)           |                |
|     transformer.resblocks.9.ln_2                            |     1.024K             |     46.08K     |
|      transformer.resblocks.9.ln_2.weight                    |      (512,)            |                |
|      transformer.resblocks.9.ln_2.bias                      |      (512,)            |                |
|     transformer.resblocks.9.token_reducer                   |                        |     0.307M     |
|    transformer.resblocks.10                                 |    3.152M              |    44.624M     |
|     transformer.resblocks.10.attn                           |     1.051M             |     19.206M    |
|      transformer.resblocks.10.attn.in_proj_weight           |      (1536, 512)       |                |
|      transformer.resblocks.10.attn.in_proj_bias             |      (1536,)           |                |
|      transformer.resblocks.10.attn.out_proj                 |      0.263M            |                |
|       transformer.resblocks.10.attn.out_proj.weight         |       (512, 512)       |                |
|       transformer.resblocks.10.attn.out_proj.bias           |       (512,)           |                |
|     transformer.resblocks.10.ln_1                           |     1.024K             |     46.08K     |
|      transformer.resblocks.10.ln_1.weight                   |      (512,)            |                |
|      transformer.resblocks.10.ln_1.bias                     |      (512,)            |                |
|     transformer.resblocks.10.mlp                            |     2.1M               |     25.166M    |
|      transformer.resblocks.10.mlp.c_fc                      |      1.051M            |      12.583M   |
|       transformer.resblocks.10.mlp.c_fc.weight              |       (2048, 512)      |                |
|       transformer.resblocks.10.mlp.c_fc.bias                |       (2048,)          |                |
|      transformer.resblocks.10.mlp.c_proj                    |      1.049M            |      12.583M   |
|       transformer.resblocks.10.mlp.c_proj.weight            |       (512, 2048)      |                |
|       transformer.resblocks.10.mlp.c_proj.bias              |       (512,)           |                |
|     transformer.resblocks.10.ln_2                           |     1.024K             |     30.72K     |
|      transformer.resblocks.10.ln_2.weight                   |      (512,)            |                |
|      transformer.resblocks.10.ln_2.bias                     |      (512,)            |                |
|     transformer.resblocks.10.token_reducer                  |                        |     0.175M     |
|    transformer.resblocks.11                                 |    3.152M              |    29.639M     |
|     transformer.resblocks.11.attn                           |     1.051M             |     12.73M     |
|      transformer.resblocks.11.attn.in_proj_weight           |      (1536, 512)       |                |
|      transformer.resblocks.11.attn.in_proj_bias             |      (1536,)           |                |
|      transformer.resblocks.11.attn.out_proj                 |      0.263M            |                |
|       transformer.resblocks.11.attn.out_proj.weight         |       (512, 512)       |                |
|       transformer.resblocks.11.attn.out_proj.bias           |       (512,)           |                |
|     transformer.resblocks.11.ln_1                           |     1.024K             |     30.72K     |
|      transformer.resblocks.11.ln_1.weight                   |      (512,)            |                |
|      transformer.resblocks.11.ln_1.bias                     |      (512,)            |                |
|     transformer.resblocks.11.mlp                            |     2.1M               |     16.777M    |
|      transformer.resblocks.11.mlp.c_fc                      |      1.051M            |      8.389M    |
|       transformer.resblocks.11.mlp.c_fc.weight              |       (2048, 512)      |                |
|       transformer.resblocks.11.mlp.c_fc.bias                |       (2048,)          |                |
|      transformer.resblocks.11.mlp.c_proj                    |      1.049M            |      8.389M    |
|       transformer.resblocks.11.mlp.c_proj.weight            |       (512, 2048)      |                |
|       transformer.resblocks.11.mlp.c_proj.bias              |       (512,)           |                |
|     transformer.resblocks.11.ln_2                           |     1.024K             |     20.48K     |
|      transformer.resblocks.11.ln_2.weight                   |      (512,)            |                |
|      transformer.resblocks.11.ln_2.bias                     |      (512,)            |                |
|     transformer.resblocks.11.token_reducer                  |                        |     79.872K    |
|  token_embedding                                            |  25.297M               |  0             |
|   token_embedding.weight                                    |   (49408, 512)         |                |
|  ln_final                                                   |  1.024K                |  20.48K        |
|   ln_final.weight                                           |   (512,)               |                |
|   ln_final.bias                                             |   (512,)               |                |
Total 19.2749504
Start training
Train Epoch: [0]  [  0/283]  eta: 0:09:52  lr: 0.00001000  loss: 0.1257  loss_ita: 0.0614  loss_kd: 0.0643  time: 2.0926  data: 0.8515  max mem: 9788
Train Epoch: [0]  [ 50/283]  eta: 0:01:39  lr: 0.00001000  loss: 0.1430  loss_ita: 0.0743  loss_kd: 0.0687  time: 0.3896  data: 0.0002  max mem: 11514
Train Epoch: [0]  [100/283]  eta: 0:01:14  lr: 0.00001000  loss: 0.2273  loss_ita: 0.1590  loss_kd: 0.0683  time: 0.3876  data: 0.0004  max mem: 11514
Train Epoch: [0]  [150/283]  eta: 0:00:53  lr: 0.00001000  loss: 0.1359  loss_ita: 0.0711  loss_kd: 0.0648  time: 0.3902  data: 0.0005  max mem: 11514
Train Epoch: [0]  [200/283]  eta: 0:00:33  lr: 0.00001000  loss: 0.1084  loss_ita: 0.0480  loss_kd: 0.0604  time: 0.3906  data: 0.0003  max mem: 11514
Train Epoch: [0]  [250/283]  eta: 0:00:13  lr: 0.00001000  loss: 0.1072  loss_ita: 0.0469  loss_kd: 0.0604  time: 0.3899  data: 0.0005  max mem: 11514
Train Epoch: [0]  [282/283]  eta: 0:00:00  lr: 0.00001000  loss: 0.1052  loss_ita: 0.0490  loss_kd: 0.0562  time: 0.3875  data: 0.0003  max mem: 11514
Train Epoch: [0] Total time: 0:01:52 (0.3967 s / it)
Averaged stats: lr: 0.0000  loss: 0.1154  loss_ita: 0.0500  loss_kd: 0.0654
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 91.71597633136095, 'txt_r5': 99.21104536489152, 'txt_r10': 99.60552268244577, 'txt_r_mean': 96.84418145956607, 'img_r1': 78.42209072978304, 'img_r5': 94.91124260355029, 'img_r10': 97.57396449704142, 'img_r_mean': 90.30243261012491, 'r_mean': 93.5733070348455}
{'txt_r1': 90.4, 'txt_r5': 98.6, 'txt_r10': 99.8, 'txt_r_mean': 96.26666666666667, 'img_r1': 77.38, 'img_r5': 94.58, 'img_r10': 97.66, 'img_r_mean': 89.87333333333333, 'r_mean': 93.07}
LOG:  {'train_lr': '0.000', 'train_loss': '0.115', 'train_loss_ita': '0.050', 'train_loss_kd': '0.065', 'val_txt_r1': 91.71597633136095, 'val_txt_r5': 99.21104536489152, 'val_txt_r10': 99.60552268244577, 'val_txt_r_mean': 96.84418145956607, 'val_img_r1': 78.42209072978304, 'val_img_r5': 94.91124260355029, 'val_img_r10': 97.57396449704142, 'val_img_r_mean': 90.30243261012491, 'val_r_mean': 93.5733070348455, 'test_txt_r1': 90.4, 'test_txt_r5': 98.6, 'test_txt_r10': 99.8, 'test_txt_r_mean': 96.26666666666667, 'test_img_r1': 77.38, 'test_img_r5': 94.58, 'test_img_r10': 97.66, 'test_img_r_mean': 89.87333333333333, 'test_r_mean': 93.07, 'epoch': 0, 'best_epoch': 0}
Train Epoch: [1]  [  0/283]  eta: 0:05:41  lr: 0.00000983  loss: 0.0602  loss_ita: 0.0043  loss_kd: 0.0559  time: 1.2080  data: 0.4306  max mem: 11521
Train Epoch: [1]  [ 50/283]  eta: 0:01:35  lr: 0.00000983  loss: 0.0912  loss_ita: 0.0410  loss_kd: 0.0502  time: 0.3917  data: 0.0005  max mem: 11523
Train Epoch: [1]  [100/283]  eta: 0:01:12  lr: 0.00000983  loss: 0.0606  loss_ita: 0.0071  loss_kd: 0.0535  time: 0.3875  data: 0.0004  max mem: 11523
Train Epoch: [1]  [150/283]  eta: 0:00:52  lr: 0.00000983  loss: 0.1176  loss_ita: 0.0638  loss_kd: 0.0538  time: 0.4009  data: 0.0004  max mem: 11525
Train Epoch: [1]  [200/283]  eta: 0:00:33  lr: 0.00000983  loss: 0.1212  loss_ita: 0.0684  loss_kd: 0.0527  time: 0.3879  data: 0.0005  max mem: 11527
Train Epoch: [1]  [250/283]  eta: 0:00:13  lr: 0.00000983  loss: 0.0840  loss_ita: 0.0316  loss_kd: 0.0524  time: 0.3908  data: 0.0005  max mem: 11527
Train Epoch: [1]  [282/283]  eta: 0:00:00  lr: 0.00000983  loss: 0.0604  loss_ita: 0.0168  loss_kd: 0.0436  time: 0.3854  data: 0.0004  max mem: 11527
Train Epoch: [1] Total time: 0:01:52 (0.3959 s / it)
Averaged stats: lr: 0.0000  loss: 0.0836  loss_ita: 0.0333  loss_kd: 0.0503
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 90.92702169625247, 'txt_r5': 99.11242603550296, 'txt_r10': 99.90138067061145, 'txt_r_mean': 96.64694280078896, 'img_r1': 79.07297830374753, 'img_r5': 95.16765285996055, 'img_r10': 97.73175542406311, 'img_r_mean': 90.65746219592374, 'r_mean': 93.65220249835636}
{'txt_r1': 90.6, 'txt_r5': 98.9, 'txt_r10': 99.6, 'txt_r_mean': 96.36666666666667, 'img_r1': 77.76, 'img_r5': 94.92, 'img_r10': 97.58, 'img_r_mean': 90.08666666666666, 'r_mean': 93.22666666666666}
LOG:  {'train_lr': '0.000', 'train_loss': '0.084', 'train_loss_ita': '0.033', 'train_loss_kd': '0.050', 'val_txt_r1': 90.92702169625247, 'val_txt_r5': 99.11242603550296, 'val_txt_r10': 99.90138067061145, 'val_txt_r_mean': 96.64694280078896, 'val_img_r1': 79.07297830374753, 'val_img_r5': 95.16765285996055, 'val_img_r10': 97.73175542406311, 'val_img_r_mean': 90.65746219592374, 'val_r_mean': 93.65220249835636, 'test_txt_r1': 90.6, 'test_txt_r5': 98.9, 'test_txt_r10': 99.6, 'test_txt_r_mean': 96.36666666666667, 'test_img_r1': 77.76, 'test_img_r5': 94.92, 'test_img_r10': 97.58, 'test_img_r_mean': 90.08666666666666, 'test_r_mean': 93.22666666666666, 'epoch': 1, 'best_epoch': 1}
Train Epoch: [2]  [  0/283]  eta: 0:05:52  lr: 0.00000933  loss: 0.0708  loss_ita: 0.0200  loss_kd: 0.0507  time: 1.2459  data: 0.4558  max mem: 11527
Train Epoch: [2]  [ 50/283]  eta: 0:01:35  lr: 0.00000933  loss: 0.1035  loss_ita: 0.0607  loss_kd: 0.0429  time: 0.3882  data: 0.0005  max mem: 11527
Train Epoch: [2]  [100/283]  eta: 0:01:13  lr: 0.00000933  loss: 0.0802  loss_ita: 0.0342  loss_kd: 0.0459  time: 0.3931  data: 0.0003  max mem: 11527
Train Epoch: [2]  [150/283]  eta: 0:00:52  lr: 0.00000933  loss: 0.0506  loss_ita: 0.0087  loss_kd: 0.0418  time: 0.3897  data: 0.0003  max mem: 11527
Train Epoch: [2]  [200/283]  eta: 0:00:32  lr: 0.00000933  loss: 0.0458  loss_ita: 0.0052  loss_kd: 0.0405  time: 0.3920  data: 0.0006  max mem: 11527
Train Epoch: [2]  [250/283]  eta: 0:00:13  lr: 0.00000933  loss: 0.0797  loss_ita: 0.0379  loss_kd: 0.0418  time: 0.3901  data: 0.0005  max mem: 11527
Train Epoch: [2]  [282/283]  eta: 0:00:00  lr: 0.00000933  loss: 0.0499  loss_ita: 0.0126  loss_kd: 0.0373  time: 0.3827  data: 0.0003  max mem: 11527
Train Epoch: [2] Total time: 0:01:51 (0.3931 s / it)
Averaged stats: lr: 0.0000  loss: 0.0690  loss_ita: 0.0267  loss_kd: 0.0423
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 91.71597633136095, 'txt_r5': 99.5069033530572, 'txt_r10': 99.90138067061145, 'txt_r_mean': 97.0414201183432, 'img_r1': 78.99408284023669, 'img_r5': 94.85207100591715, 'img_r10': 97.55424063116371, 'img_r_mean': 90.46679815910585, 'r_mean': 93.75410913872452}
{'txt_r1': 91.2, 'txt_r5': 98.6, 'txt_r10': 99.6, 'txt_r_mean': 96.46666666666665, 'img_r1': 77.94, 'img_r5': 94.98, 'img_r10': 97.58, 'img_r_mean': 90.16666666666667, 'r_mean': 93.31666666666666}
LOG:  {'train_lr': '0.000', 'train_loss': '0.069', 'train_loss_ita': '0.027', 'train_loss_kd': '0.042', 'val_txt_r1': 91.71597633136095, 'val_txt_r5': 99.5069033530572, 'val_txt_r10': 99.90138067061145, 'val_txt_r_mean': 97.0414201183432, 'val_img_r1': 78.99408284023669, 'val_img_r5': 94.85207100591715, 'val_img_r10': 97.55424063116371, 'val_img_r_mean': 90.46679815910585, 'val_r_mean': 93.75410913872452, 'test_txt_r1': 91.2, 'test_txt_r5': 98.6, 'test_txt_r10': 99.6, 'test_txt_r_mean': 96.46666666666665, 'test_img_r1': 77.94, 'test_img_r5': 94.98, 'test_img_r10': 97.58, 'test_img_r_mean': 90.16666666666667, 'test_r_mean': 93.31666666666666, 'epoch': 2, 'best_epoch': 2}
Train Epoch: [3]  [  0/283]  eta: 0:05:51  lr: 0.00000854  loss: 0.0532  loss_ita: 0.0126  loss_kd: 0.0406  time: 1.2410  data: 0.4504  max mem: 11527
Train Epoch: [3]  [ 50/283]  eta: 0:01:34  lr: 0.00000854  loss: 0.0367  loss_ita: 0.0016  loss_kd: 0.0351  time: 0.3850  data: 0.0003  max mem: 11527
Train Epoch: [3]  [100/283]  eta: 0:01:12  lr: 0.00000854  loss: 0.0432  loss_ita: 0.0080  loss_kd: 0.0353  time: 0.3886  data: 0.0007  max mem: 11527
Train Epoch: [3]  [150/283]  eta: 0:00:52  lr: 0.00000854  loss: 0.0549  loss_ita: 0.0205  loss_kd: 0.0344  time: 0.3906  data: 0.0003  max mem: 11527
Train Epoch: [3]  [200/283]  eta: 0:00:32  lr: 0.00000854  loss: 0.0502  loss_ita: 0.0135  loss_kd: 0.0367  time: 0.3910  data: 0.0003  max mem: 11527
Train Epoch: [3]  [250/283]  eta: 0:00:12  lr: 0.00000854  loss: 0.0408  loss_ita: 0.0043  loss_kd: 0.0366  time: 0.3896  data: 0.0006  max mem: 11527
Train Epoch: [3]  [282/283]  eta: 0:00:00  lr: 0.00000854  loss: 0.0418  loss_ita: 0.0046  loss_kd: 0.0372  time: 0.3846  data: 0.0004  max mem: 11527
Train Epoch: [3] Total time: 0:01:51 (0.3926 s / it)
Averaged stats: lr: 0.0000  loss: 0.0587  loss_ita: 0.0219  loss_kd: 0.0368
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 92.50493096646943, 'txt_r5': 98.71794871794872, 'txt_r10': 99.70414201183432, 'txt_r_mean': 96.97567389875083, 'img_r1': 79.07297830374753, 'img_r5': 95.06903353057199, 'img_r10': 97.83037475345168, 'img_r_mean': 90.65746219592374, 'r_mean': 93.81656804733728}
{'txt_r1': 91.7, 'txt_r5': 98.6, 'txt_r10': 99.7, 'txt_r_mean': 96.66666666666667, 'img_r1': 77.96, 'img_r5': 94.98, 'img_r10': 97.6, 'img_r_mean': 90.17999999999999, 'r_mean': 93.42333333333333}
LOG:  {'train_lr': '0.000', 'train_loss': '0.059', 'train_loss_ita': '0.022', 'train_loss_kd': '0.037', 'val_txt_r1': 92.50493096646943, 'val_txt_r5': 98.71794871794872, 'val_txt_r10': 99.70414201183432, 'val_txt_r_mean': 96.97567389875083, 'val_img_r1': 79.07297830374753, 'val_img_r5': 95.06903353057199, 'val_img_r10': 97.83037475345168, 'val_img_r_mean': 90.65746219592374, 'val_r_mean': 93.81656804733728, 'test_txt_r1': 91.7, 'test_txt_r5': 98.6, 'test_txt_r10': 99.7, 'test_txt_r_mean': 96.66666666666667, 'test_img_r1': 77.96, 'test_img_r5': 94.98, 'test_img_r10': 97.6, 'test_img_r_mean': 90.17999999999999, 'test_r_mean': 93.42333333333333, 'epoch': 3, 'best_epoch': 3}
Train Epoch: [4]  [  0/283]  eta: 0:05:52  lr: 0.00000750  loss: 0.0773  loss_ita: 0.0389  loss_kd: 0.0384  time: 1.2450  data: 0.4833  max mem: 11527
Train Epoch: [4]  [ 50/283]  eta: 0:01:37  lr: 0.00000750  loss: 0.0540  loss_ita: 0.0183  loss_kd: 0.0357  time: 0.3910  data: 0.0004  max mem: 11527
Train Epoch: [4]  [100/283]  eta: 0:01:14  lr: 0.00000750  loss: 0.0394  loss_ita: 0.0054  loss_kd: 0.0340  time: 0.3911  data: 0.0007  max mem: 11527
Train Epoch: [4]  [150/283]  eta: 0:00:53  lr: 0.00000750  loss: 0.0551  loss_ita: 0.0216  loss_kd: 0.0335  time: 0.3928  data: 0.0004  max mem: 11527
Train Epoch: [4]  [200/283]  eta: 0:00:33  lr: 0.00000750  loss: 0.0524  loss_ita: 0.0219  loss_kd: 0.0305  time: 0.3885  data: 0.0004  max mem: 11527
Train Epoch: [4]  [250/283]  eta: 0:00:13  lr: 0.00000750  loss: 0.0664  loss_ita: 0.0354  loss_kd: 0.0310  time: 0.3895  data: 0.0005  max mem: 11527
Train Epoch: [4]  [282/283]  eta: 0:00:00  lr: 0.00000750  loss: 0.0810  loss_ita: 0.0471  loss_kd: 0.0339  time: 0.3796  data: 0.0003  max mem: 11527
Train Epoch: [4] Total time: 0:01:51 (0.3951 s / it)
Averaged stats: lr: 0.0000  loss: 0.0518  loss_ita: 0.0186  loss_kd: 0.0332
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 91.61735700197238, 'txt_r5': 99.11242603550296, 'txt_r10': 99.70414201183432, 'txt_r_mean': 96.81130834976989, 'img_r1': 80.05917159763314, 'img_r5': 95.2465483234714, 'img_r10': 97.49506903353057, 'img_r_mean': 90.9335963182117, 'r_mean': 93.8724523339908}
{'txt_r1': 91.3, 'txt_r5': 99.2, 'txt_r10': 99.9, 'txt_r_mean': 96.8, 'img_r1': 78.96, 'img_r5': 94.68, 'img_r10': 97.48, 'img_r_mean': 90.37333333333333, 'r_mean': 93.58666666666667}
LOG:  {'train_lr': '0.000', 'train_loss': '0.052', 'train_loss_ita': '0.019', 'train_loss_kd': '0.033', 'val_txt_r1': 91.61735700197238, 'val_txt_r5': 99.11242603550296, 'val_txt_r10': 99.70414201183432, 'val_txt_r_mean': 96.81130834976989, 'val_img_r1': 80.05917159763314, 'val_img_r5': 95.2465483234714, 'val_img_r10': 97.49506903353057, 'val_img_r_mean': 90.9335963182117, 'val_r_mean': 93.8724523339908, 'test_txt_r1': 91.3, 'test_txt_r5': 99.2, 'test_txt_r10': 99.9, 'test_txt_r_mean': 96.8, 'test_img_r1': 78.96, 'test_img_r5': 94.68, 'test_img_r10': 97.48, 'test_img_r_mean': 90.37333333333333, 'test_r_mean': 93.58666666666667, 'epoch': 4, 'best_epoch': 4}
Train Epoch: [5]  [  0/283]  eta: 0:06:12  lr: 0.00000629  loss: 0.0327  loss_ita: 0.0020  loss_kd: 0.0307  time: 1.3180  data: 0.5261  max mem: 11527
Train Epoch: [5]  [ 50/283]  eta: 0:01:34  lr: 0.00000629  loss: 0.0330  loss_ita: 0.0029  loss_kd: 0.0301  time: 0.3902  data: 0.0003  max mem: 11527
Train Epoch: [5]  [100/283]  eta: 0:01:12  lr: 0.00000629  loss: 0.0526  loss_ita: 0.0235  loss_kd: 0.0292  time: 0.3902  data: 0.0004  max mem: 11527
Train Epoch: [5]  [150/283]  eta: 0:00:52  lr: 0.00000629  loss: 0.0542  loss_ita: 0.0236  loss_kd: 0.0306  time: 0.3900  data: 0.0006  max mem: 11527
Train Epoch: [5]  [200/283]  eta: 0:00:32  lr: 0.00000629  loss: 0.0463  loss_ita: 0.0173  loss_kd: 0.0290  time: 0.3869  data: 0.0006  max mem: 11527
Train Epoch: [5]  [250/283]  eta: 0:00:12  lr: 0.00000629  loss: 0.0393  loss_ita: 0.0105  loss_kd: 0.0288  time: 0.3894  data: 0.0004  max mem: 11527
Train Epoch: [5]  [282/283]  eta: 0:00:00  lr: 0.00000629  loss: 0.0343  loss_ita: 0.0044  loss_kd: 0.0299  time: 0.3811  data: 0.0004  max mem: 11527
Train Epoch: [5] Total time: 0:01:51 (0.3925 s / it)
Averaged stats: lr: 0.0000  loss: 0.0460  loss_ita: 0.0159  loss_kd: 0.0301
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 91.91321499013807, 'txt_r5': 99.30966469428007, 'txt_r10': 99.90138067061145, 'txt_r_mean': 97.0414201183432, 'img_r1': 79.62524654832347, 'img_r5': 95.2268244575937, 'img_r10': 97.73175542406311, 'img_r_mean': 90.86127547666008, 'r_mean': 93.95134779750164}
{'txt_r1': 90.5, 'txt_r5': 99.1, 'txt_r10': 99.8, 'txt_r_mean': 96.46666666666665, 'img_r1': 78.58, 'img_r5': 95.52, 'img_r10': 97.78, 'img_r_mean': 90.62666666666667, 'r_mean': 93.54666666666665}
LOG:  {'train_lr': '0.000', 'train_loss': '0.046', 'train_loss_ita': '0.016', 'train_loss_kd': '0.030', 'val_txt_r1': 91.91321499013807, 'val_txt_r5': 99.30966469428007, 'val_txt_r10': 99.90138067061145, 'val_txt_r_mean': 97.0414201183432, 'val_img_r1': 79.62524654832347, 'val_img_r5': 95.2268244575937, 'val_img_r10': 97.73175542406311, 'val_img_r_mean': 90.86127547666008, 'val_r_mean': 93.95134779750164, 'test_txt_r1': 90.5, 'test_txt_r5': 99.1, 'test_txt_r10': 99.8, 'test_txt_r_mean': 96.46666666666665, 'test_img_r1': 78.58, 'test_img_r5': 95.52, 'test_img_r10': 97.78, 'test_img_r_mean': 90.62666666666667, 'test_r_mean': 93.54666666666665, 'epoch': 5, 'best_epoch': 5}
Train Epoch: [6]  [  0/283]  eta: 0:05:49  lr: 0.00000500  loss: 0.0498  loss_ita: 0.0199  loss_kd: 0.0299  time: 1.2348  data: 0.5244  max mem: 11527
Train Epoch: [6]  [ 50/283]  eta: 0:01:35  lr: 0.00000500  loss: 0.0325  loss_ita: 0.0039  loss_kd: 0.0286  time: 0.3917  data: 0.0007  max mem: 11527
Train Epoch: [6]  [100/283]  eta: 0:01:13  lr: 0.00000500  loss: 0.0296  loss_ita: 0.0027  loss_kd: 0.0270  time: 0.3886  data: 0.0003  max mem: 11527
Train Epoch: [6]  [150/283]  eta: 0:00:52  lr: 0.00000500  loss: 0.0279  loss_ita: 0.0002  loss_kd: 0.0277  time: 0.3891  data: 0.0003  max mem: 11527
Train Epoch: [6]  [200/283]  eta: 0:00:33  lr: 0.00000500  loss: 0.0367  loss_ita: 0.0073  loss_kd: 0.0294  time: 0.3891  data: 0.0004  max mem: 11527
Train Epoch: [6]  [250/283]  eta: 0:00:13  lr: 0.00000500  loss: 0.0563  loss_ita: 0.0294  loss_kd: 0.0269  time: 0.3857  data: 0.0005  max mem: 11527
Train Epoch: [6]  [282/283]  eta: 0:00:00  lr: 0.00000500  loss: 0.0365  loss_ita: 0.0107  loss_kd: 0.0258  time: 0.3813  data: 0.0003  max mem: 11527
Train Epoch: [6] Total time: 0:01:51 (0.3947 s / it)
Averaged stats: lr: 0.0000  loss: 0.0428  loss_ita: 0.0143  loss_kd: 0.0285
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 92.80078895463511, 'txt_r5': 99.11242603550296, 'txt_r10': 99.90138067061145, 'txt_r_mean': 97.27153188691652, 'img_r1': 79.64497041420118, 'img_r5': 95.16765285996055, 'img_r10': 97.63313609467455, 'img_r_mean': 90.81525312294544, 'r_mean': 94.04339250493098}
{'txt_r1': 92.3, 'txt_r5': 98.7, 'txt_r10': 99.7, 'txt_r_mean': 96.89999999999999, 'img_r1': 79.72, 'img_r5': 95.18, 'img_r10': 97.7, 'img_r_mean': 90.86666666666667, 'r_mean': 93.88333333333333}
LOG:  {'train_lr': '0.000', 'train_loss': '0.043', 'train_loss_ita': '0.014', 'train_loss_kd': '0.029', 'val_txt_r1': 92.80078895463511, 'val_txt_r5': 99.11242603550296, 'val_txt_r10': 99.90138067061145, 'val_txt_r_mean': 97.27153188691652, 'val_img_r1': 79.64497041420118, 'val_img_r5': 95.16765285996055, 'val_img_r10': 97.63313609467455, 'val_img_r_mean': 90.81525312294544, 'val_r_mean': 94.04339250493098, 'test_txt_r1': 92.3, 'test_txt_r5': 98.7, 'test_txt_r10': 99.7, 'test_txt_r_mean': 96.89999999999999, 'test_img_r1': 79.72, 'test_img_r5': 95.18, 'test_img_r10': 97.7, 'test_img_r_mean': 90.86666666666667, 'test_r_mean': 93.88333333333333, 'epoch': 6, 'best_epoch': 6}
Train Epoch: [7]  [  0/283]  eta: 0:06:34  lr: 0.00000371  loss: 0.0280  loss_ita: 0.0022  loss_kd: 0.0258  time: 1.3953  data: 0.5599  max mem: 11527
Train Epoch: [7]  [ 50/283]  eta: 0:01:35  lr: 0.00000371  loss: 0.0275  loss_ita: 0.0011  loss_kd: 0.0264  time: 0.3898  data: 0.0004  max mem: 11527
Train Epoch: [7]  [100/283]  eta: 0:01:13  lr: 0.00000371  loss: 0.0361  loss_ita: 0.0081  loss_kd: 0.0281  time: 0.3890  data: 0.0005  max mem: 11527
Train Epoch: [7]  [150/283]  eta: 0:00:52  lr: 0.00000371  loss: 0.0318  loss_ita: 0.0059  loss_kd: 0.0259  time: 0.3893  data: 0.0004  max mem: 11527
Train Epoch: [7]  [200/283]  eta: 0:00:32  lr: 0.00000371  loss: 0.0345  loss_ita: 0.0090  loss_kd: 0.0255  time: 0.3865  data: 0.0004  max mem: 11527
Train Epoch: [7]  [250/283]  eta: 0:00:12  lr: 0.00000371  loss: 0.0439  loss_ita: 0.0194  loss_kd: 0.0245  time: 0.3869  data: 0.0003  max mem: 11527
Train Epoch: [7]  [282/283]  eta: 0:00:00  lr: 0.00000371  loss: 0.0299  loss_ita: 0.0045  loss_kd: 0.0254  time: 0.3864  data: 0.0003  max mem: 11527
Train Epoch: [7] Total time: 0:01:50 (0.3922 s / it)
Averaged stats: lr: 0.0000  loss: 0.0378  loss_ita: 0.0119  loss_kd: 0.0259
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 92.70216962524655, 'txt_r5': 99.5069033530572, 'txt_r10': 100.0, 'txt_r_mean': 97.40302432610126, 'img_r1': 80.78895463510848, 'img_r5': 95.70019723865877, 'img_r10': 97.75147928994083, 'img_r_mean': 91.41354372123602, 'r_mean': 94.40828402366864}
{'txt_r1': 91.5, 'txt_r5': 99.0, 'txt_r10': 99.8, 'txt_r_mean': 96.76666666666667, 'img_r1': 79.78, 'img_r5': 95.64, 'img_r10': 98.02, 'img_r_mean': 91.14666666666666, 'r_mean': 93.95666666666666}
LOG:  {'train_lr': '0.000', 'train_loss': '0.038', 'train_loss_ita': '0.012', 'train_loss_kd': '0.026', 'val_txt_r1': 92.70216962524655, 'val_txt_r5': 99.5069033530572, 'val_txt_r10': 100.0, 'val_txt_r_mean': 97.40302432610126, 'val_img_r1': 80.78895463510848, 'val_img_r5': 95.70019723865877, 'val_img_r10': 97.75147928994083, 'val_img_r_mean': 91.41354372123602, 'val_r_mean': 94.40828402366864, 'test_txt_r1': 91.5, 'test_txt_r5': 99.0, 'test_txt_r10': 99.8, 'test_txt_r_mean': 96.76666666666667, 'test_img_r1': 79.78, 'test_img_r5': 95.64, 'test_img_r10': 98.02, 'test_img_r_mean': 91.14666666666666, 'test_r_mean': 93.95666666666666, 'epoch': 7, 'best_epoch': 7}
Train Epoch: [8]  [  0/283]  eta: 0:05:55  lr: 0.00000250  loss: 0.0365  loss_ita: 0.0108  loss_kd: 0.0258  time: 1.2575  data: 0.4529  max mem: 11527
Train Epoch: [8]  [ 50/283]  eta: 0:01:34  lr: 0.00000250  loss: 0.0356  loss_ita: 0.0096  loss_kd: 0.0260  time: 0.3871  data: 0.0004  max mem: 11527
Train Epoch: [8]  [100/283]  eta: 0:01:12  lr: 0.00000250  loss: 0.0459  loss_ita: 0.0206  loss_kd: 0.0253  time: 0.3919  data: 0.0003  max mem: 11527
Train Epoch: [8]  [150/283]  eta: 0:00:52  lr: 0.00000250  loss: 0.0324  loss_ita: 0.0069  loss_kd: 0.0255  time: 0.3859  data: 0.0003  max mem: 11527
Train Epoch: [8]  [200/283]  eta: 0:00:32  lr: 0.00000250  loss: 0.0326  loss_ita: 0.0081  loss_kd: 0.0244  time: 0.3892  data: 0.0004  max mem: 11527
Train Epoch: [8]  [250/283]  eta: 0:00:12  lr: 0.00000250  loss: 0.0548  loss_ita: 0.0300  loss_kd: 0.0248  time: 0.3892  data: 0.0004  max mem: 11527
Train Epoch: [8]  [282/283]  eta: 0:00:00  lr: 0.00000250  loss: 0.0570  loss_ita: 0.0318  loss_kd: 0.0252  time: 0.3782  data: 0.0003  max mem: 11527
Train Epoch: [8] Total time: 0:01:50 (0.3904 s / it)
Averaged stats: lr: 0.0000  loss: 0.0363  loss_ita: 0.0111  loss_kd: 0.0253
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 92.60355029585799, 'txt_r5': 99.30966469428007, 'txt_r10': 99.90138067061145, 'txt_r_mean': 97.27153188691649, 'img_r1': 80.63116370808679, 'img_r5': 95.34516765285996, 'img_r10': 97.96844181459566, 'img_r_mean': 91.31492439184747, 'r_mean': 94.29322813938198}
LOG:  {'train_lr': '0.000', 'train_loss': '0.036', 'train_loss_ita': '0.011', 'train_loss_kd': '0.025', 'val_txt_r1': 92.60355029585799, 'val_txt_r5': 99.30966469428007, 'val_txt_r10': 99.90138067061145, 'val_txt_r_mean': 97.27153188691649, 'val_img_r1': 80.63116370808679, 'val_img_r5': 95.34516765285996, 'val_img_r10': 97.96844181459566, 'val_img_r_mean': 91.31492439184747, 'val_r_mean': 94.29322813938198, 'test_txt_r1': 91.5, 'test_txt_r5': 99.0, 'test_txt_r10': 99.8, 'test_txt_r_mean': 96.76666666666667, 'test_img_r1': 79.78, 'test_img_r5': 95.64, 'test_img_r10': 98.02, 'test_img_r_mean': 91.14666666666666, 'test_r_mean': 93.95666666666666, 'epoch': 8, 'best_epoch': 7}
Train Epoch: [9]  [  0/283]  eta: 0:05:45  lr: 0.00000146  loss: 0.0577  loss_ita: 0.0317  loss_kd: 0.0261  time: 1.2218  data: 0.4287  max mem: 11527
Train Epoch: [9]  [ 50/283]  eta: 0:01:38  lr: 0.00000146  loss: 0.0269  loss_ita: 0.0015  loss_kd: 0.0254  time: 0.3888  data: 0.0004  max mem: 11527
Train Epoch: [9]  [100/283]  eta: 0:01:14  lr: 0.00000146  loss: 0.0308  loss_ita: 0.0064  loss_kd: 0.0244  time: 0.3903  data: 0.0004  max mem: 11527
Train Epoch: [9]  [150/283]  eta: 0:00:53  lr: 0.00000146  loss: 0.0690  loss_ita: 0.0440  loss_kd: 0.0251  time: 0.3871  data: 0.0004  max mem: 11527
Train Epoch: [9]  [200/283]  eta: 0:00:32  lr: 0.00000146  loss: 0.0432  loss_ita: 0.0187  loss_kd: 0.0245  time: 0.3927  data: 0.0005  max mem: 11527
Train Epoch: [9]  [250/283]  eta: 0:00:13  lr: 0.00000146  loss: 0.0319  loss_ita: 0.0067  loss_kd: 0.0253  time: 0.3896  data: 0.0005  max mem: 11527
Train Epoch: [9]  [282/283]  eta: 0:00:00  lr: 0.00000146  loss: 0.0247  loss_ita: 0.0003  loss_kd: 0.0243  time: 0.3829  data: 0.0003  max mem: 11527
Train Epoch: [9] Total time: 0:01:51 (0.3949 s / it)
Averaged stats: lr: 0.0000  loss: 0.0356  loss_ita: 0.0105  loss_kd: 0.0251
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 93.09664694280079, 'txt_r5': 99.40828402366864, 'txt_r10': 99.90138067061145, 'txt_r_mean': 97.46877054569363, 'img_r1': 80.82840236686391, 'img_r5': 95.68047337278107, 'img_r10': 98.08678500986193, 'img_r_mean': 91.5318869165023, 'r_mean': 94.50032873109797}
{'txt_r1': 93.4, 'txt_r5': 99.1, 'txt_r10': 99.8, 'txt_r_mean': 97.43333333333334, 'img_r1': 80.26, 'img_r5': 95.82, 'img_r10': 98.0, 'img_r_mean': 91.36, 'r_mean': 94.39666666666668}
LOG:  {'train_lr': '0.000', 'train_loss': '0.036', 'train_loss_ita': '0.011', 'train_loss_kd': '0.025', 'val_txt_r1': 93.09664694280079, 'val_txt_r5': 99.40828402366864, 'val_txt_r10': 99.90138067061145, 'val_txt_r_mean': 97.46877054569363, 'val_img_r1': 80.82840236686391, 'val_img_r5': 95.68047337278107, 'val_img_r10': 98.08678500986193, 'val_img_r_mean': 91.5318869165023, 'val_r_mean': 94.50032873109797, 'test_txt_r1': 93.4, 'test_txt_r5': 99.1, 'test_txt_r10': 99.8, 'test_txt_r_mean': 97.43333333333334, 'test_img_r1': 80.26, 'test_img_r5': 95.82, 'test_img_r10': 98.0, 'test_img_r_mean': 91.36, 'test_r_mean': 94.39666666666668, 'epoch': 9, 'best_epoch': 9}
Train Epoch: [10]  [  0/283]  eta: 0:05:54  lr: 0.00000067  loss: 0.0287  loss_ita: 0.0043  loss_kd: 0.0244  time: 1.2517  data: 0.4565  max mem: 11527
Train Epoch: [10]  [ 50/283]  eta: 0:01:34  lr: 0.00000067  loss: 0.0268  loss_ita: 0.0024  loss_kd: 0.0245  time: 0.3899  data: 0.0003  max mem: 11527
Train Epoch: [10]  [100/283]  eta: 0:01:13  lr: 0.00000067  loss: 0.0422  loss_ita: 0.0182  loss_kd: 0.0240  time: 0.3856  data: 0.0004  max mem: 11527
Train Epoch: [10]  [150/283]  eta: 0:00:52  lr: 0.00000067  loss: 0.0376  loss_ita: 0.0137  loss_kd: 0.0238  time: 0.3886  data: 0.0005  max mem: 11527
Train Epoch: [10]  [200/283]  eta: 0:00:32  lr: 0.00000067  loss: 0.0444  loss_ita: 0.0196  loss_kd: 0.0248  time: 0.3873  data: 0.0004  max mem: 11527
Train Epoch: [10]  [250/283]  eta: 0:00:12  lr: 0.00000067  loss: 0.0251  loss_ita: 0.0020  loss_kd: 0.0231  time: 0.3882  data: 0.0004  max mem: 11527
Train Epoch: [10]  [282/283]  eta: 0:00:00  lr: 0.00000067  loss: 0.0344  loss_ita: 0.0100  loss_kd: 0.0244  time: 0.3848  data: 0.0003  max mem: 11527
Train Epoch: [10] Total time: 0:01:51 (0.3927 s / it)
Averaged stats: lr: 0.0000  loss: 0.0341  loss_ita: 0.0096  loss_kd: 0.0245
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 93.09664694280079, 'txt_r5': 99.70414201183432, 'txt_r10': 99.90138067061145, 'txt_r_mean': 97.56738987508218, 'img_r1': 81.24260355029585, 'img_r5': 95.77909270216962, 'img_r10': 98.06706114398422, 'img_r_mean': 91.69625246548323, 'r_mean': 94.6318211702827}
{'txt_r1': 92.8, 'txt_r5': 99.2, 'txt_r10': 99.7, 'txt_r_mean': 97.23333333333333, 'img_r1': 80.3, 'img_r5': 95.74, 'img_r10': 98.06, 'img_r_mean': 91.36666666666667, 'r_mean': 94.30000000000001}
LOG:  {'train_lr': '0.000', 'train_loss': '0.034', 'train_loss_ita': '0.010', 'train_loss_kd': '0.024', 'val_txt_r1': 93.09664694280079, 'val_txt_r5': 99.70414201183432, 'val_txt_r10': 99.90138067061145, 'val_txt_r_mean': 97.56738987508218, 'val_img_r1': 81.24260355029585, 'val_img_r5': 95.77909270216962, 'val_img_r10': 98.06706114398422, 'val_img_r_mean': 91.69625246548323, 'val_r_mean': 94.6318211702827, 'test_txt_r1': 92.8, 'test_txt_r5': 99.2, 'test_txt_r10': 99.7, 'test_txt_r_mean': 97.23333333333333, 'test_img_r1': 80.3, 'test_img_r5': 95.74, 'test_img_r10': 98.06, 'test_img_r_mean': 91.36666666666667, 'test_r_mean': 94.30000000000001, 'epoch': 10, 'best_epoch': 10}
Train Epoch: [11]  [  0/283]  eta: 0:06:14  lr: 0.00000017  loss: 0.0259  loss_ita: 0.0008  loss_kd: 0.0251  time: 1.3217  data: 0.4953  max mem: 11527
Train Epoch: [11]  [ 50/283]  eta: 0:01:34  lr: 0.00000017  loss: 0.0242  loss_ita: 0.0005  loss_kd: 0.0237  time: 0.3871  data: 0.0003  max mem: 11527
Train Epoch: [11]  [100/283]  eta: 0:01:12  lr: 0.00000017  loss: 0.0242  loss_ita: 0.0004  loss_kd: 0.0237  time: 0.3842  data: 0.0003  max mem: 11527
Train Epoch: [11]  [150/283]  eta: 0:00:52  lr: 0.00000017  loss: 0.0470  loss_ita: 0.0231  loss_kd: 0.0239  time: 0.3853  data: 0.0003  max mem: 11527
Train Epoch: [11]  [200/283]  eta: 0:00:32  lr: 0.00000017  loss: 0.0249  loss_ita: 0.0003  loss_kd: 0.0246  time: 0.3846  data: 0.0003  max mem: 11527
Train Epoch: [11]  [250/283]  eta: 0:00:12  lr: 0.00000017  loss: 0.0362  loss_ita: 0.0127  loss_kd: 0.0234  time: 0.3881  data: 0.0003  max mem: 11527
Train Epoch: [11]  [282/283]  eta: 0:00:00  lr: 0.00000017  loss: 0.0418  loss_ita: 0.0170  loss_kd: 0.0248  time: 0.3793  data: 0.0003  max mem: 11527
Train Epoch: [11] Total time: 0:01:51 (0.3923 s / it)
Averaged stats: lr: 0.0000  loss: 0.0340  loss_ita: 0.0097  loss_kd: 0.0243
Computing features for evaluation...
Computing features for evaluation...
{'txt_r1': 93.09664694280079, 'txt_r5': 99.60552268244577, 'txt_r10': 100.0, 'txt_r_mean': 97.56738987508218, 'img_r1': 81.36094674556213, 'img_r5': 95.75936883629191, 'img_r10': 98.12623274161736, 'img_r_mean': 91.74884944115713, 'r_mean': 94.65811965811966}
{'txt_r1': 92.8, 'txt_r5': 99.2, 'txt_r10': 99.7, 'txt_r_mean': 97.23333333333333, 'img_r1': 80.42, 'img_r5': 95.86, 'img_r10': 98.06, 'img_r_mean': 91.44666666666667, 'r_mean': 94.34}
LOG:  {'train_lr': '0.000', 'train_loss': '0.034', 'train_loss_ita': '0.010', 'train_loss_kd': '0.024', 'val_txt_r1': 93.09664694280079, 'val_txt_r5': 99.60552268244577, 'val_txt_r10': 100.0, 'val_txt_r_mean': 97.56738987508218, 'val_img_r1': 81.36094674556213, 'val_img_r5': 95.75936883629191, 'val_img_r10': 98.12623274161736, 'val_img_r_mean': 91.74884944115713, 'val_r_mean': 94.65811965811966, 'test_txt_r1': 92.8, 'test_txt_r5': 99.2, 'test_txt_r10': 99.7, 'test_txt_r_mean': 97.23333333333333, 'test_img_r1': 80.42, 'test_img_r5': 95.86, 'test_img_r10': 98.06, 'test_img_r_mean': 91.44666666666667, 'test_r_mean': 94.34, 'epoch': 11, 'best_epoch': 11}
Training time 0:30:12
